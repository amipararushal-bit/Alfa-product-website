<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Marketplace - ALFA ART</title>
<style>
:root {
  --primary: #007BFF;
  --primary-dark: #0056b3;
  --bg: #f5f7fa;
  --card-bg: #fff;
  --text-dark: #333;
  --text-muted: #777;
  --radius: 12px;
  --shadow: rgba(0,0,0,0.08);
}
* { box-sizing: border-box; margin:0; padding:0; font-family: Arial, sans-serif; }
body { background: var(--bg); padding:20px; }

.header {
  display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;
}
.header .brand { display:flex; align-items:center; gap:12px; }
.header .brand img { width:48px; height:48px; object-fit:cover; border-radius:8px; }
.header .brand .title { font-size:20px; color:var(--text-dark); font-weight:700; }

.header-actions {
  display: flex; align-items: center; gap: 15px;
}
.logout-btn {
  background:#ff4b5c; color:#fff; border:none; padding:8px 16px; border-radius:8px; cursor:pointer;
  font-weight: 600;
}
.logout-btn:hover { background:#d93645; }

/* --- Search and Cart Styles --- */
.search-container {
  position: relative;
  display: flex;
  align-items: center;
}
.search-input {
  padding: 8px 12px;
  border: 1px solid #ccc;
  border-radius: 8px;
  width: 200px;
  font-size: 14px;
}
.cart-icon {
  position: relative;
  cursor: pointer;
  padding: 5px;
}
.cart-icon img {
  width: 24px;
  height: 24px;
}
.cart-count {
  position: absolute;
  top: -5px;
  right: -5px;
  background-color: var(--primary);
  color: white;
  border-radius: 50%;
  padding: 2px 6px;
  font-size: 10px;
  font-weight: 700;
}
/* --- Filter Styles --- */
.filter-bar {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    gap: 20px;
    padding: 15px 0;
    margin-bottom: 20px;
    background: var(--card-bg);
    border-radius: var(--radius);
    padding: 15px 20px;
    box-shadow: 0 2px 8px var(--shadow);
}
.filter-bar label {
    font-size: 14px;
    color: var(--text-dark);
    font-weight: 600;
}
.filter-bar select {
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 8px;
    font-size: 14px;
    background-color: white;
}
/* --- Product Card Styles --- */
.marketplace {
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(180px,1fr));
  gap:20px;
}

.product-card {
  background: var(--card-bg);
  border-radius: var(--radius);
  box-shadow: 0 4px 12px var(--shadow);
  padding:15px;
  text-align:center;
  transition: transform .2s, box-shadow .2s;
}
.product-card.hidden { display: none; }
.product-card:hover { transform: translateY(-5px); box-shadow:0 8px 20px var(--shadow);}
.product-card img { width:100%; border-radius:8px; height:120px; object-fit:cover; margin-bottom:10px;}
.product-card h3 { font-size:16px; color: var(--text-dark); margin-bottom:6px;}
.product-card p { color: var(--text-muted); font-size:14px; margin-bottom:10px;}
.product-card button {
  background: var(--primary); color:#fff; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:600;
  margin-top: 5px;
}
.product-card button:hover { background: var(--primary-dark); }
.add-to-cart-btn {
    background: #28a745;
    color: #fff;
    border: none;
    padding: 8px 12px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    margin-right: 5px;
}
.add-to-cart-btn:hover { background: #1e7e34; }


/* --- Modal Styles --- */
.modal {
  display:none; /* Crucial: This is what the JS toggles */
  position:fixed; inset:0; background: rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:100;
}
.modal-content {
  background: #fff; padding:20px; border-radius: var(--radius); width:90%; max-width:360px; text-align:center;
  box-shadow:0 6px 20px var(--shadow);
  position:relative;
}
.modal-content h3 { font-size:18px; margin-bottom:10px; color: var(--text-dark);}
.close {
  position:absolute; top:10px; right:12px; font-size:24px; cursor:pointer; color:#888;
}
.close:hover { color:#000;}

/* Styles specific to product detail modal */
#productModal .modal-content img { width:80%; max-width:250px; margin-bottom:15px; border-radius:8px;}
#payButton {
  background: var(--primary); color:#fff; border:none; padding:10px 20px; border-radius:8px; cursor:pointer; font-weight:600;
}
#payButton:hover { background: var(--primary-dark);}

/* Styles specific to cart modal */
#cartItemsList { max-height: 200px; overflow-y: auto; margin-bottom: 15px; }
#cartTotal { font-weight: 700; color: var(--text-dark); margin-bottom: 15px; }
#checkoutButton {
    background: #ffc107; color: #333; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 600;
}
#checkoutButton:hover { background: #e0a800; }
</style>
</head>
<body>

<div class="header">
  <div class="brand">
    <img src="logo.png" alt="ALFA ART logo">
    <div class="title">ALFA ART Marketplace</div>
  </div>
  <div class="header-actions">
    <div class="search-container">
        <input type="text" id="searchInput" class="search-input" placeholder="Search products..." onkeyup="filterProducts()">
    </div>
    <div class="cart-icon" onclick="openCartModal()">
        <img src="cart-icon.png" alt="Cart">
        <span class="cart-count" id="cartCount">0</span>
    </div>
    <button class="logout-btn" onclick="logout()">Logout</button>
  </div>
</div>

<div class="filter-bar">
    <label for="priceFilter">Filter by Price:</label>
    <select id="priceFilter" onchange="filterProducts()">
        <option value="all">All Prices</option>
        <option value="low">₹0 - ₹2000</option>
        <option value="medium">₹2001 - ₹3000</option>
        <option value="high">₹3001+</option>
    </select>
</div>
<div class="marketplace" id="marketplace">
  <div class="product-card" data-name="Product 1" data-price="2500"><img src="product 1.jpg" alt=""><h3>Product 1</h3><p>Price: ₹2500</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 1',2500,'product 1.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 2" data-price="2800"><img src="product 2.jpg" alt=""><h3>Product 2</h3><p>Price: ₹2800</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 2',2800,'product 2.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 3" data-price="3000"><img src="product 3.jpg" alt=""><h3>Product 3</h3><p>Price: ₹3000</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 3',3000,'product 3.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 4" data-price="2500"><img src="product 4.jpg" alt=""><h3>Product 4</h3><p>Price: ₹2500</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 4',2500,'product 4.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 5" data-price="2400"><img src="product 5.jpg" alt=""><h3>Product 5</h3><p>Price: ₹2400</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 5',2400,'product 5.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 6" data-price="3100"><img src="product 6.jpg" alt=""><h3>Product 6</h3><p>Price: ₹3100</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 6',3100,'product 6.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 7" data-price="2500"><img src="product 7.jpg" alt=""><h3>Product 7</h3><p>Price: ₹2500</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 7',2500,'product 7.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 8" data-price="4000"><img src="product 8.jpg" alt=""><h3>Product 8</h3><p>Price: ₹4000</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 8',4000,'product 8.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 9" data-price="2500"><img src="product 9.jpg" alt=""><h3>Product 9</h3><p>Price: ₹2500</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 9',2500,'product 9.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 10" data-price="1500"><img src="product 10.jpg" alt=""><h3>Product 10</h3><p>Price: ₹1500</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 10',1500,'product 10.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 11" data-price="1400"><img src="product 11.jpg" alt=""><h3>Product 11</h3><p>Price: ₹1400</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 11',1400,'product 11.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 12" data-price="1190"><img src="product 12.jpg" alt=""><h3>Product 12</h3><p>Price: ₹1190</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 12',1190,'product 12.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 13" data-price="2900"><img src="product 13.jpg" alt=""><h3>Product 13</h3><p>Price: ₹2900</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 13',2900,'product 13.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 14" data-price="2400"><img src="product 14.jpg" alt=""><h3>Product 14</h3><p>Price: ₹2400</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 14',2400,'product 14.jpg')">View Details</button></div>
  <div class="product-card" data-name="Product 15" data-price="2030"><img src="product 15.jpg" alt=""><h3>Product 15</h3><p>Price: ₹2030</p><button class="add-to-cart-btn" onclick="addToCart(this)">Add to Cart</button><button onclick="openModal('Product 15',2030,'product 15.jpg')">View Details</button></div>
</div>

<div id="cartModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeCartModal()">&times;</span>
        <h3>Your Shopping Cart</h3>
        <div id="cartItemsList">
            </div>
        <p id="cartTotal">Total: ₹0</p>
        <button id="checkoutButton">Proceed to Checkout</button>
    </div>
</div>

<div id="productModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <img id="modalImage" src="">
    <h3 id="modalName"></h3>
    <p id="modalPrice"></p>
    <button id="payButton">Buy Now</button>
  </div>
</div>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
let currentProduct = null, currentPrice = 0;
let cartItems = []; // Array to store all products added to cart

// --- Cart Management Functions ---

function updateCartCount() {
    // Updates the number displayed on the cart icon
    document.getElementById('cartCount').innerText = cartItems.length;
}

function addToCart(buttonElement) {
    const productCard = buttonElement.closest('.product-card');
    const name = productCard.getAttribute('data-name');
    const price = parseInt(productCard.getAttribute('data-price'));

    // Add product to the global cart array
    cartItems.push({ name: name, price: price });
    
    updateCartCount();
    alert(name + " added to cart!");
}

function renderCart() {
    const listElement = document.getElementById('cartItemsList');
    const totalElement = document.getElementById('cartTotal');
    let total = 0;
    
    listElement.innerHTML = ''; // Clear existing content

    if (cartItems.length === 0) {
        listElement.innerHTML = '<p style="color:var(--text-muted);">Your cart is empty.</p>';
    } else {
        const ul = document.createElement('ul');
        ul.style.listStyle = 'none';
        ul.style.textAlign = 'left';
        ul.style.paddingLeft = '0';

        cartItems.forEach((item) => {
            const li = document.createElement('li');
            li.style.padding = '8px 0';
            li.style.borderBottom = '1px dashed #eee';
            // Display item details
            li.innerHTML = `<strong>${item.name}</strong> - ₹${item.price}`; 
            ul.appendChild(li);
            total += item.price;
        });
        listElement.appendChild(ul);
    }
    
    totalElement.innerText = 'Total: ₹' + total;
    
    document.getElementById('checkoutButton').onclick = () => {
        alert('Initiating checkout for total: ₹' + total);
        closeCartModal();
    };
}

function openCartModal() {
    // 1. Render/load the content
    renderCart(); 
    // 2. Display the modal (This is the fix!)
    document.getElementById('cartModal').style.display = 'flex'; 
}

function closeCartModal() { 
    document.getElementById('cartModal').style.display = 'none'; 
}

// --- Product Detail Modal and Razorpay Logic ---

function openModal(name,price,img){
  currentProduct=name; currentPrice=price;
  document.getElementById('modalName').innerText=name;
  document.getElementById('modalPrice').innerText='Price: ₹'+price;
  document.getElementById('modalImage').src=img;
  document.getElementById('productModal').style.display='flex';
}
function closeModal(){ document.getElementById('productModal').style.display='none'; }

document.getElementById('payButton').addEventListener('click',()=>{
  const options = {
    "key": "rzp_test_RbZBLvi84I1oqa",
    "amount": currentPrice * 100,
    "currency": "INR",
    "name": "ALFA ART",
    "description": currentProduct,
    "image": "logo.png",
    "handler": function(res){
      alert("Payment successful! ID: "+res.razorpay_payment_id);
      closeModal();
    },
    "theme":{"color":"#007BFF"}
  };
  new Razorpay(options).open();
});

function logout(){
  localStorage.removeItem('loggedIn');
  alert('Logged out!');
  window.location.href='index.html';
}

// --- Filter and Search Logic ---
function filterProducts() {
    const searchInput = document.getElementById('searchInput').value.toLowerCase();
    const priceFilterValue = document.getElementById('priceFilter').value;
    const productCards = document.querySelectorAll('.product-card');

    productCards.forEach(card => {
        const productName = card.getAttribute('data-name').toLowerCase();
        const productPrice = parseInt(card.getAttribute('data-price'));

        const matchesSearch = productName.includes(searchInput);
        
        let matchesPrice = true;
        if (priceFilterValue === 'low') {
            matchesPrice = productPrice <= 2000;
        } else if (priceFilterValue === 'medium') {
            matchesPrice = productPrice >= 2001 && productPrice <= 3000;
        } else if (priceFilterValue === 'high') {
            matchesPrice = productPrice >= 3001;
        }

        // Show card only if it passes BOTH search and price filter
        if (matchesSearch && matchesPrice) {
            card.classList.remove('hidden');
        } else {
            card.classList.add('hidden');
        }
    });
}

// Global click handler to close modals when clicking outside
window.onclick = function(e) { 
    const productModal = document.getElementById('productModal');
    const cartModal = document.getElementById('cartModal');
    
    if (e.target === productModal) {
        closeModal();
    }
    if (e.target === cartModal) {
        closeCartModal();
    }
}
</script>

</body>
</html>
